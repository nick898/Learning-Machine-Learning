dat[1,7]
dat[1,7] + dat[1,9]
is.na(dat[1,7])
length(dat[,7])
length(dat[1:17,7])
dat[1:17,7]
dat[1:18,7]
dat[1:17,7]
T = dat[1:17,7]
T = 0
T = dat[1:17,7]
T[1:17]
T[1:17] = 0
T
T = dat[1:17,c(7,8)]
T
T[1:17,c(7,8)] = 0
T[1:17,7] = 0
T
T[1:17,7] = as.data.frame(0)
T = dat[1:17,7]
T
data.frame(T)
data.frame(0)
data.frame(seq(0,17))
dat[1,7]
if (is.na(dat[1,7]) == TRUE){dat[1,7] = 0} + dat[1,9]
View(dat)
View(dat)
dat[1,7] = NA
View(dat)
View(dat)
View(dat)
View(dat)
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
View(dat)
View(dat)
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
df.m <- melt(dat[1:20,],id.vars='YEAR')
View(df.m)
View(df.m)
df.m <- melt(dat[1:20,c(1,3:ncol(dat))],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1))
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
ggplot() +
df.m <- melt(dat[syear:eyear,20],id.vars='YEAR') +
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
ggplot() +
df.m <- melt(dat[1:20,],id.vars='YEAR') +
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
ggplot()+
df.m <- melt(dat[syear:eyear,20],id.vars='YEAR') +
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
ggplot()+
df.m <- melt(dat[1:20,],id.vars='YEAR') +
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
ggplot()+
df.m <- melt(dat[1:20,c(1,15,3)],id.vars='YEAR') +
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
df.m <- melt(dat[syear:eyear,c(1,15,3)],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1)) +
labs(x = "Year", y = "Records") +
ggtitle("Violent Crime Records and Property Crime Records by Year") +
theme(text = element_text(size = 20)) +
scale_fill_discrete(name="Type of Crime",
labels = c("Property Crime", "Violent Crime"))
remove(df.m)
df.m <- melt(dat[syear:eyear,c(1,15,3)],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1)) +
labs(x = "Year", y = "Records") +
ggtitle("Violent Crime Records and Property Crime Records by Year") +
theme(text = element_text(size = 20)) +
scale_fill_discrete(name="Type of Crime",
labels = c("Property Crime", "Violent Crime"))
df.m <- melt(dat[syear:eyear,c(1,15,3)],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1)) +
labs(x = "Year", y = "Records") +
ggtitle("Violent Crime Records and Property Crime Records by Year") +
theme(text = element_text(size = 20)) +
scale_fill_discrete(name="Type of Crime",
labels = c("Property Crime", "Violent Crime"))
df.m <- melt(dat[syear:eyear,c(1,15,3)],id.vars='YEAR')
df.m <- melt(dat[1:20,c(1,15,3)],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1)) +
labs(x = "Year", y = "Records") +
ggtitle("Violent Crime Records and Property Crime Records by Year") +
theme(text = element_text(size = 20)) +
scale_fill_discrete(name="Type of Crime",
labels = c("Property Crime", "Violent Crime"))
df.m <- melt(dat[1:20,],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1)) +
labs(x = "Year", y = "Records") +
ggtitle("Violent Crime Records and Property Crime Records by Year") +
theme(text = element_text(size = 20)) +
scale_fill_discrete(name="Type of Crime",
labels = c("Property Crime", "Violent Crime"))
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
df.m <- melt(dat[1:20,],id.vars='YEAR')
ggplot(df.m, aes(YEAR, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
scale_x_continuous(breaks=seq(1996,2015,1)) +
labs(x = "Year", y = "Records") +
ggtitle("Violent Crime Records and Property Crime Records by Year") +
theme(text = element_text(size = 20)) +
scale_fill_discrete(name="Type of Crime",labels = c("Population", "Violent Crime", "Stuff"))
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
View(dat)
View(dat)
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
c(1,4:14,16:21)
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
View(dat)
View(dat)
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
runApp('C:/Users/nkallfa36/Desktop/Shiny/Table 1')
source('C:/Users/nkallfa36/Desktop/R/Analyzing Baseball Data with R Chapter 2/stats.R')
library(Lohman)
library(Lehman)
Library()
library()
library
library(Lahman)
data("Pitching")
data(Pitching)
Pitching = Pitching
library(plyr)
career.pitching = ddply(Pitching, .(playerID), stats)
career.pitching = ddply(Pitching, .(playerID), stats)
?data.frame
dataframe.AB <- ddply(Batting, .(playerID), summarize,
Career.AB=sum(AB, na.rm=TRUE))
)
data("Batting")
Batting = Batting
dataframe.AB <- ddply(Batting, .(playerID), summarize,
Career.AB=sum(AB, na.rm=TRUE))
source('C:/Users/nkallfa36/Desktop/R/Analyzing Baseball Data with R Chapter 2/stats.R')
career.pitching = ddply(Pitching, .(playerID), stats)
warnings()
dataframe.AB <- ddply(Pitching, .(playerID), summarize,
Career.SO=sum(SO, na.rm=TRUE))
source('C:/Users/nkallfa36/Desktop/R/Analyzing Baseball Data with R Chapter 2/stats.R')
career.pitching = ddply(Pitching, .(playerID), stats)
source('C:/Users/nkallfa36/Desktop/R/Analyzing Baseball Data with R Chapter 2/stats.R')
career.pitching = ddply(Pitching, .(playerID), stats)
remove(Batting,dataframe.AB)
Pitching = merge(Pitching, career.pitching, by = playerID)
Pitching = merge(Pitching, career.pitching, by = "playerID")
?subset
Pitching = subset(Pitching, IPOuts >= 10000)
with(Pitching, plot(Pitching$MidYear, pitching$SO/Pitching$BB))
with(Pitching, plot(Pitching$MidYear, Pitching$SO/Pitching$BB))
with(Pitching, plot(MidYear, SO/BB))
with(Pitching, plot(MidYear, SO.y/BB.y))
OrtizOPS <- read.table("C:/Users/nkallfa36/Desktop/R/Blog/OrtizOPS.RData", quote="\"")
View(OrtizOPS)
View(OrtizOPS)
library(Lahman)
Batting = Batting
Batting
Batting = subset(Batting, teamID == "BOS")
library(plyr)
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
Sox5 = YearsWithRedSox(Batting)
SoxB = Batting
Sox5 = YearsWithRedSox(Batting)
source('C:/Users/nkallfa36/Desktop/R/Blog/ComputeOPS.R')
Sox5OPS = ComputeOPS.R(SoxB$playerID, SoxB)
Sox5OPS = ComputeOPS(SoxB$playerID, SoxB)
View(Sox5OPS)
plot(1:4278, Sox5OPS$OPS)
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
Sox5 = YearsWithRedSox(Batting)
Sox10 = YearsWithRedSox(Batting)
Batting = subset(Batting, teamID = "BOS")
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
SoxB = YearsWithRedSox(Batting)
SoxB = subset(Batting, teamID = "BOS")
Sox5 = YearsWithRedSox(SoxB)
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
Sox10 = YearsWithRedSox(SoxB)
SoxB = subset(Batting, teamID == "BOS")
Sox10 = YearsWithRedSox(SoxB)
length(Sox10)
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
Sox5 = YearsWithRedSox(SoxB)
length(Sox10)
length(Sox5)
remove(Sox10)
source('C:/Users/nkallfa36/Desktop/R/Blog/ComputeOPS.R')
Sox5OPS = ComputeOPS(Sox5,SoxB)
Sox5OPS
plot(1:176, Sox5OPS$OPS)
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = 171, col = "red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = 171, legend = "David Ortiz" col = "red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = 171, legend = "David Ortiz", col = "red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft", legend = "David Ortiz", col = "red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft", legend = "David Ortiz", col = 2)
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft", legend = "David Ortiz", col = par("red"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black")) + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(80, 75, pch = c(1,1), col = "red", "David Ortiz", bty = "o")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"))  + abline(h = mean(Sox5OPS$OPS), col = "blue")
legend(80, 75, pch = c(1,1), col = "red", "David Ortiz", bty = "o")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + text(140,73, cex=.8, pos=4, “Orange line is\n sample average\n weight”)
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + text(140,73, cex=.8, pos=4, “Orange line is\n sample average\n weight”)
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + text(140,73, cex=.8, pos=4, "sdfg”)
)
)
)
aa
asc
q111
w
esf
ewf
erf
er
g
l)));
;
?
!
stop
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + text(x = 10, y = 50, "dfgdfg")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + text(x = 100, y = 150, labels=  "dfgdfg")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft", pch = c(171, Sox5OPS$OPS[171]), lty = c(1,1), col = c("red", "blye"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft", pch = c(171, Sox5OPS$OPS[171]), lty = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend, pch = c(171, Sox5OPS$OPS[171]), lty = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = "David Ortiz", pch = c(171, Sox5OPS$OPS[171]), lty = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(171, Sox5OPS$OPS[171]), lty = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), lty = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), lty = 1, col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), lty = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1,1), col = c"red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = 1, col = c"red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = 1, col = c"red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1,1), col = c"red")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1,1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1),lty = c(1), col = c("red", "blue"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), pch = c(1), col = c("red"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red")) + text(x = 10, labels = "dfgdfg")
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red")) + text(x = 10, labels = c("dfgdfg")
)
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red")) + text(x = 10, labels = c("dfgdfg"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red")) + text(x = "topright", labels = c("dfgdfg"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red")) + text(6,2, labels = c("dfgdfg"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), pch = c(1), col = c("red"))
text(6,2,labels = c("dfdfg"))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 1,lty = c(1,2), pch = c(1))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 1,lty = c(1), pch = c(1))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red"),lwd = 1,lty = c(0), pch = c(1))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red"),lwd = 1,lty = c(0), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("blue"), lwd = 1, lty = c(1), pch = c(NA))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red"),lwd = 1,lty = c(0), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("blue"), lwd = 1, lty = c(1), pch = c(NA))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 1,lty = c(0), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("red","blue"), lwd = 1, lty = c(1), pch = c(NA))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 1,lty = c(0), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("red","blue"), lwd = 1, lty = c(1,1), pch = c(NA))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 1,lty = c(1), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("red","blue"), lwd = 1, lty = c(1), pch = c(NA))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 0,lty = c(0), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("red","blue"), lwd = 1, lty = c(1), pch = c(NA))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "Mean OPS"), col = c("red", "blue"),lwd = 0,lty = c(0), pch = c(1)) + legend(x = "topleft", legend = c("David Ortiz", "Mean OPS"), col = c("red","blue"), lwd = 1, lty = c(1)
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), col = c("red"), pch = c(1))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), col = c("red"), pch = c(1,1))
Sox5OPSO = Sox5OPS[order(Sox5OPS$OPS,)]
Sox5OPSO = Sox5OPS[order(Sox5OPS$OPS),]
Sox5OPSO = Sox5OPS[order(-Sox5OPS$OPS),]
Sox5OPSO
Sox5OPSO[1:10]
Sox5OPSO[1:10,1:10]
Sox5OPSO[1:10,]
Sox10 = YearsWithRedSox(SoxB)
Sox10OPS = ComputeOPS(Sox10,SoxB)
Sox10OPS
Sox10OPS[order(Sox10OPS$OPS),]
Sox10OPS[order(-Sox10OPS$OPS),]
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
Sox10 = YearsWithRedSox(SoxB)
Sox10OPS = ComputeOPS(Sox10,SoxB)
Sox10OPS[order(-Sox10OPS$OPS),]
Sox10OPS$playerID == "willite01"
Sox10OPS$playerID = "willite01"
Sox10OPS
Sox10OPS = ComputeOPS(Sox10,SoxB)
Sox5OPSO
SoxB[1,:]
SoxB[1,1:22]
source('C:/Users/nkallfa36/Desktop/R/Blog/CareerOPS.R')
source('C:/Users/nkallfa36/Desktop/R/Blog/CareerOPS.R')
Top5 = CareerOPS(SoxB)
Top5
Top5 = subset(SoxB, playerID == "ortizda01" | playerID == "ruthba01" | playerID == "ramirma02" | playerID == "foxxji01" | playerID == "willite01")
Top5
source('C:/Users/nkallfa36/Desktop/R/Analyzing Baseball Data with R Chapter 2/stats2.R')
stats2(Top5)
library(plyr)
Top5OPS = ddply(Top5, .(playerID, yearID), stats2)
Top5OPS
plot(Top5OPS$OPS[1:7])
plot(Top5OPS$OPS[1:7]) + lines(Top5OPS$OPS[1:7])
plot(Top5OPS$OPS[1:7], col = "red") + lines(Top5OPS$OPS[1:7])
plot(Top5OPS$OPS[1:7]) + lines(Top5OPS$OPS[1:7], col = "red")
plot(Top5OPS$OPS[8:20]) + lines(Top5OPS$OPS[8:20], col = "blue")
plot(Top5OPS$OPS[1:7]) + lines(Top5OPS$OPS[1:7], col = "red") + plot(Top5OPS$OPS[8:20]) + lines(Top5OPS$OPS[8:20], col = "blue")
plot(Top5OPS$OPS[1:7]) + lines(Top5OPS$OPS[1:7], col = "red") + plot(Top5OPS$OPS[8:20]) + lines(Top5OPS$OPS[8:20], col = "blue")
plot(Top5OPS$OPS[1:7], Top5OPS$OPS[8:20]) + lines(Top5OPS$OPS[1:7], col = "red") + lines(Top5OPS$OPS[8:20], col = "blue")
plot(Top5OPS$OPS[35:53]) + lines(Top5OPS$OPS[35:53], col = "blue")
clc
library(Lahman)
Batting = Batting
SoxB = subset(Batting, teamID = "BOS")
SoxB = subset(Batting, teamID == "BOS")
View(SoxB)
View(SoxB)
Add = data.frame(playerID)
Add = data.frame(playerID = "ortizda01")
Add
Add = data.frame(playerID = "ortizda01", yearID = 2016, stint = 1, teamID = "BOS", lgID = "AL", G = 151, AB = 537, R = 79, H = 169, X2B = 48, X3B = 1, HR = 38, RBI = 127, SB = 2, CS = 0, BB = 80, SO = 86, IBB = 15, HBP = 2, SH = 0, SF = 7, GIDP = 22)
SoxB = rbind(SoxB,Add)
SoxB[playerID == "ortizda01"]
SoxB[playerID == "ortizda01",]
SoxB[yearID == 2016,]
clc
SoxB[:,2]
SoxB[,2]
View(SoxB)
View(SoxB)
clc
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
source('C:/Users/nkallfa36/Desktop/R/Blog/ComputeOPS.R')
SoxN = YearsWithRedSox(SoxB)
SoxN
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
SoxN
SoxN = YearsWithRedSox(SoxB)
SoxBOPS = ComputeOPS(SoxN,SoxB)
View(SoxBOPS)
View(SoxBOPS)
Sox5OPS = SoxBOPS
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz"), col = c("red"), pch = c(1))
plot(1:176, Sox5OPS$OPS, col = ifelse(Sox5OPS$playerID == "ortizda01", "red", "black"), xlab = "Players", ylab = "OPS", main = "Career OPS for all Red Sox players with team for 5 or more years")  + abline(h = mean(Sox5OPS$OPS), col = "blue") + legend(x = "topleft",legend = c("David Ortiz", "dsgsfdg"), col = c("red"), pch = c(1))
mean(Sox5OPS$OPS)
OrtizDox = subset(SoxB, playerID == "ortizda01")
OrtizSox = subset(SoxB, playerID == "ortizda01")
plot(OrtizSox$OPS)
View(OrtizSox)
View(OrtizSox)
source('C:/Users/nkallfa36/Desktop/R/Analyzing Baseball Data with R Chapter 2/stats2.R')
stats2(OrtizSox)
library(plyr)
ddply(OrtizSox, .(yearID), stats2)
OrtizOPS = ddply(OrtizSox, .(yearID), stats2)
plot(OrtizOPS$OPS)
B2003P =  subset(Batting, yearID <= 2015 & yearID >= 2003)
stats2(B2003P)
B2003POPS = ddply(B2003, .(playerID), stats2)
B2003POPS = ddply(B2003P, .(playerID), stats2)
View(B2003POPS)
View(B2003POPS)
View(B2003P)
View(B2003P)
B2003POPS = ddply(B2003P, .(playerID,yearID), stats2)
View(B2003POPS)
View(B2003POPS)
B2003POPS = ddply(B2003P, .(playerID,yearID,stint), stats2)
mean(B2003POPS$OPS)
mean(B2003POPS$OPS, na.rm = TRUE)
B2003POPS = ddply(B2003P, .(playerID,yearID,stint), stats2, na.rm = TRUE)
plot(OrtizOPS$OPS) + lines()
plot(OrtizOPS$OPS) + lines(OrtizOPS$OPS)
plot(2003:2016, OrtizOPS$OPS) + lines(OrtizOPS$OPS)
plot(2003:2016, OrtizOPS$OPS) + lines(2003:2016, OrtizOPS$OPS)
plot(2003:2016, OrtizOPS$OPS, xlab = "Year", ylab = "OPS", main = "David Ortiz OPS from 2003 - 2016") + lines(2003:2016, OrtizOPS$OPS)
max(OrtizOPS$OPS)
min(OrtizOPS$OPS)
mean(OrtizOPS$OPS)
View(SoxBOPS)
View(SoxBOPS)
SoxN
source('C:/Users/nkallfa36/Desktop/R/Blog/YearsWithRedSox.R')
source('C:/Users/nkallfa36/Desktop/R/Blog/TeamAVGOPS.R')
source('C:/Users/nkallfa36/Desktop/R/Blog/ComputeOPS.R')
Test1 = YearsWithRedSox(Batting,5,150)
Test1 = YearsWithRedSox(SoxB,5,150)
Test1 = TeamAVGOPS(SoxB)
Test1
Test1 = ddply(SoxB, .(playerID, yearID), TeamAVGOPS)
Test1
source('C:/Users/nkallfa36/Desktop/R/Blog/TeamAVGOPS.R')
setwd("C:/Users/nkallfa36/Desktop/Blog R Code/Similarity Scores")
load(Batting.Rda)
load("Batting.Rda")
load("C:/Users/nkallfa36/Desktop/Blog R Code/Similarity Scores/Batting.Rda")
Bat = read.csv("Batting.csv")
M = Master
library(Lahman)
M = Master
M2 = data.frame(M$playerID,M$nameGiven)
head(M2)
colnames(M2)
colnames(M2)[1]
colnames(M2)[1] = "playerID"
colnames(M2)[2] = "nameGiven"
head(M2)
Bat23 = AgeEqPlayer(23,Bat)
source('C:/Users/nkallfa36/Desktop/Blog R Code/Similarity Scores/AgeEqPlayer.R')
source('C:/Users/nkallfa36/Desktop/Blog R Code/Similarity Scores/NearNeigh.R')
Bat23 = AgeEqPlayer(23,Bat)
NearNeigh("bogaexa01", 10,Bat23)
Out = NearNeigh("bogaexa01", 10,Bat23)
Test = merge(M2,Out)
head(Test)
head(Master)
M2 = data.frame(M$playerID,M$nameFirst,M$nameLast)
colnames(M2)
colnames(M2) = c("playerID", "nameFirst", "nameLast")
head(M2)
Test = merge(M2,Out)
head(Test)
Test
source('C:/Users/nkallfa36/Desktop/Blog R Code/Similarity Scores/script.R')
NearestNeighbors
source('C:/Users/nkallfa36/Desktop/Blog R Code/Similarity Scores/script.R')
NearestNeighbors
